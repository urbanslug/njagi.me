<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="utf-8">

        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
              rel="stylesheet"
              integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
              crossorigin="anonymous"
        >

        

        <link rel="stylesheet" href="https://njagi.me/style.css">

        <title>Mostly Programming</title>
    </head>

    <body>
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
            <div class="container">
                <a class="navbar-brand" href="/">Home</a>

                <ul class="navbar-nav me-auto mb-2 mb-lg-0">
                    <li class="nav-item"><a class="nav-link" href="/posts/">Posts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/notes/">Notes</a></li>
                    <li class="nav-item"><a class="nav-link" href="/wiki/">Wiki</a></li>
                    <li class="nav-item"><a class="nav-link" href="/tags/">Tags</a></li>
                </ul>

                <ul class="nav navbar-nav navbar-right">
                    <li class="nav-item"><a class="nav-link" href="/about/">About</a></li>
                </ul>

            </div> <!-- container -->
        </nav> <!-- end nav -->

        <div class="container">
            <div class="margin-vertical-20">
                

<div class="row">
    <div class="row justify-content-end"> <!-- start post heading -->
        <div class="col-md-10">

            <h1 id="post-title">Google Summer of Code (2015)</h1>

            <div id="post-metadata">
                July 19, 2015

                <p>
                    
                    Tags:
                    <span class="tags">
                        
                        <button type="button" class="btn btn-link btn-sm">
                            <a href="https://njagi.me/tags/programming-gsoc-yesod-yesod-devel/">Programming, GSoC, Yesod, Yesod-Devel</a>
                        </button>
                        
                    </span>
                    
                </p>

            </div> <!-- page metadata -->
        </div>
    </div> <!-- end post heading -->

    <div class="row justify-content-center">  <!-- start post content -->
        <div class="col-md-8">
            <p>This post is long overdue and I should've started writing on this a while ago but oh well I will write as much in the remaining time and try to make up for lost time.</p>
<span id="continue-reading"></span>
<p>So I sent in a proposal for Google Summer of Code aimed at <a href="https://www.haskell.org">haskell.org</a>.
The aim of the proposal was <strong>To build an improved yesod-devel server</strong>. Let the name not fool you, this server is supposed to work with all <a href="https://www.yesodweb.com/book/web-application-interface">WAI</a> compliant haskell web applications such as yesod, spock, scotty applications among others.
My mentor has been <a href="https://github.com/snoyberg">Michael Snoyman</a>. I've also been working closely with <a href="https://github.com/mgsloan">Michael Sloan</a> and <a href="https://github.com/ncreep">Daniel Beskin</a>.
It started on a high note. I was added to the <a href="https://github.com/fpco">FP Complete github organisation</a>. That had me very excited because of the kind of people who are in that organisation plus it's <strong>THE HASKELL</strong> organisation in my opinion. So that's the social aspect. Let's talk programming.</p>
<h1 id="ide-backend">ide-backend</h1>
<p>So FP Complete recently released a library that acts as a wrapper around the <a href="https://wiki.haskell.org/GHC/As_a_library">GHC API</a>, that is, <a href="https://hackage.haskell.org/package/ide-backend-0.9.0.2">ide-backend</a> (I wrote about it in an earlier post).
This library was extracted from the online FP Complete haskell ide. It was therefore still aimed at working  a cleint - server model where the client and server are on different boxes. The client (the package depending on ide-backend) had to explicitly specify the files to be copied from the cleint to the server. This worked in the FP Complete use case but wouldn't work in our use case.</p>
<p>So we had to make it work in a local environment. This was my first task.</p>
<p>The aim here was to enable automatic source file (as well as data files and everything else) discovery by ide-backend so that it can submit these files for compilationa by GHC.<br />
To do this, one has to specify that they want to use ide-backend with a local working directory under <code>configLocalWorkingDir</code> in <a href="http://hackage.haskell.org/package/ide-backend-0.9.0.2/docs/IdeSession.html#v:defaultSessionConfig"><code>defaultSessionConfig</code></a>. <code>configLocalWorkingDir</code> is a value of type <code>Maybe FilePath</code>. It defaults to (Nothing :: Maybe FilePath) and has ide-backend working in a client-server environment. When <code>configLocalWorkingDir</code> is set it uses the given file path as the place it will look for source files, data files and everything in between.</p>
<p>Functionality for ide-backend to work in a non-server environment was finally merged in <a href="https://github.com/fpco/ide-backend/tree/19561d9ff5f496d6556f38992bc8d08896d54091">this commit onwards on github</a>. It's not yet on the hackage version of ide-backend as of writing this post but it will be pushed soon enough.</p>
<h1 id="yesod-devel">yesod-devel</h1>
<p>Then came the challenge of yesod-devel. This is the &quot;client&quot; in our case that depends on ide-backend. 
Quite honestly the fact is that ide-backend is the one doing most of the heavy lifting while yesod-devel coordinates everything.</p>
<p>The objectives of yesod-devel are:</p>
<ul>
<li>Automatic source and data file discovery.</li>
<li>Load code</li>
<li>Compile to bytecode</li>
<li>Run the code</li>
<li>Read environment variables</li>
<li>Grab compiler error messages and display them on the browser</li>
<li>Listening for changes in the current working directory</li>
<li>Automatic code reloading and recompilation</li>
<li>Perform reverse proxying for the web application</li>
</ul>

        </div>
    </div>  <!-- end post content -->

</div> <!--  -->



            </div>
        </div>
    </body>
</html>
